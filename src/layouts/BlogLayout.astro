---
import "../styles/global.css";
import MainLayout from "./MainLayout.astro";
import BlogFooter from "../components/blog/BlogFooter.astro";

import OverlaySearch from "../components/blog/SearchOverlay.astro";

interface Props {
  title: string;
  description?: string;
}
const {
  title = "SaiBLOG | Saif Abdelrazek",
  description = "Personal blog of Saif Abdelrazek || Could sometimes be the trash of my mind",
}: Props = Astro.props;
---

<MainLayout title={title} description={description}>
  <div
    class="min-h-screen w-full bg-blue-50 transition-colors duration-300 dark:bg-gradient-to-br dark:from-[#0f172a] dark:via-[#1e293b] dark:to-[#0a192f]"
  >
    <main class="container mx-auto px-2 py-12">
      <section
        class="mx-auto max-w-4xl rounded-2xl border border-blue-100 bg-white/80 p-8 shadow-2xl backdrop-blur-md transition-colors duration-300 dark:border-sky-900 dark:bg-gradient-to-br dark:from-slate-900/80 dark:via-slate-800/80 dark:to-slate-900/60 dark:shadow-2xl dark:backdrop-blur-md"
      >
        <h1
          class="mb-2 text-3xl font-extrabold tracking-tight text-blue-700 drop-shadow dark:text-sky-200"
        >
          {title}
        </h1>
        {
          description && (
            <p class="mb-6 text-blue-700/90 dark:text-sky-100/90">
              {description}
            </p>
          )
        }
        <OverlaySearch />
        <button
          id="open-search-overlay"
          class="ml-2 rounded-md bg-blue-600 px-3 py-2 text-white shadow hover:bg-blue-700 dark:bg-sky-700 dark:hover:bg-sky-500"
          type="button"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="mr-1 inline h-5 w-5"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
          Search
        </button>
        <slot />
      </section>
    </main>
    <BlogFooter />
  </div>

  <script>
    // import search functions.
    import {
      OpenSearch,
      InitSearch,
    } from "astro-collection-search/example/overlay/overlay-search.ts";

    // call init to set search options.
    InitSearch({
      create_link: (result) => {
        // Generate a slug from the entry path, removing the file extension
        if (
          result?.frontmatter?.slug &&
          typeof result.frontmatter.slug === "string"
        ) {
          return "blog/" + result.frontmatter.slug;
        }
        const slug = result.entry.replace(/\.mdx?$/, "");
        return `blog/${slug.startsWith("/") ? slug.slice(1) : slug}/`; // Ensure the slug starts without a leading slash
      },
      max: 12,
    });
    ``;
    // open the search dialog
    document
      .querySelector("#open-search-overlay")
      ?.addEventListener("click", () => OpenSearch());
  </script>
</MainLayout>
